<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1"
 width="900px" height="694px"
 viewBox="0 0 900 694"
 xmlns="http://www.w3.org/2000/svg" shape-rendering="crispEdges"
 stroke-width="1" text-rendering="geometricPrecision">
<polygon fill="white" points="118,7 180,7 180,16 118,16"/>
<text x="150" y="16" textLength="60" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

Provisioner
</text>
<polygon fill="white" points="429,7 469,7 469,16 429,16"/>
<text x="450" y="16" textLength="39" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

Node 1
</text>
<polygon fill="white" points="729,7 769,7 769,16 729,16"/>
<text x="750" y="16" textLength="39" font-family="Helvetica" font-size="12" fill="black" text-anchor="middle">

Node 2
</text>
<line x1="150" y1="22" x2="150" y2="39" stroke="black"/>
<line x1="450" y1="22" x2="450" y2="39" stroke="black"/>
<line x1="750" y1="22" x2="750" y2="39" stroke="black"/>
<line x1="150" y1="39" x2="150" y2="67" stroke="black"/>
<line x1="450" y1="39" x2="450" y2="67" stroke="black"/>
<line x1="750" y1="39" x2="750" y2="67" stroke="black"/>
<polygon fill="white" points="314,39 586,39 586,61 314,61"/>
<polygon fill="white" points="308,45 592,45 592,55 308,55"/>
<circle fill="white" cx="314" cy="45" r="6"/>
<circle fill="white" cx="586" cy="45" r="6"/>
<circle fill="white" cx="314" cy="55" r="6"/>
<circle fill="white" cx="586" cy="55" r="6"/>
<line x1="314" y1="39" x2="586" y2="39" stroke="black"/>
<line x1="314" y1="61" x2="586" y2="61" stroke="black"/>
<line x1="308" y1="45" x2="308" y2="55" stroke="black"/>
<line x1="592" y1="45" x2="592" y2="55" stroke="black"/>
<path d="M 308 45 A6,6 0 0,1 314,39" stroke="black" fill="none"/><path d="M 586 39 A6,6 0 0,1 592,45" stroke="black" fill="none"/><path d="M 592 55 A6,6 0 0,1 586,61" stroke="black" fill="none"/><path d="M 314 61 A6,6 0 0,1 308,55" stroke="black" fill="none"/><polygon fill="white" points="410,46 489,46 489,55 410,55"/>
<text x="411" y="55" textLength="77" font-family="Helvetica" font-size="12" fill="black">
Unprovisioned
</text>
<polygon fill="white" points="614,39 886,39 886,61 614,61"/>
<polygon fill="white" points="608,45 892,45 892,55 608,55"/>
<circle fill="white" cx="614" cy="45" r="6"/>
<circle fill="white" cx="886" cy="45" r="6"/>
<circle fill="white" cx="614" cy="55" r="6"/>
<circle fill="white" cx="886" cy="55" r="6"/>
<line x1="614" y1="39" x2="886" y2="39" stroke="black"/>
<line x1="614" y1="61" x2="886" y2="61" stroke="black"/>
<line x1="608" y1="45" x2="608" y2="55" stroke="black"/>
<line x1="892" y1="45" x2="892" y2="55" stroke="black"/>
<path d="M 608 45 A6,6 0 0,1 614,39" stroke="black" fill="none"/><path d="M 886 39 A6,6 0 0,1 892,45" stroke="black" fill="none"/><path d="M 892 55 A6,6 0 0,1 886,61" stroke="black" fill="none"/><path d="M 614 61 A6,6 0 0,1 608,55" stroke="black" fill="none"/><polygon fill="white" points="696,46 803,46 803,55 696,55"/>
<text x="697" y="55" textLength="105" font-family="Helvetica" font-size="12" fill="black">
Already provisioned
</text>
<line x1="150" y1="67" x2="150" y2="84" stroke="black"/>
<line x1="450" y1="67" x2="450" y2="84" stroke="black"/>
<line x1="750" y1="67" x2="750" y2="84" stroke="black"/>
<line x1="150" y1="84" x2="150" y2="112" stroke="black"/>
<line x1="450" y1="84" x2="450" y2="112" stroke="black"/>
<line x1="750" y1="84" x2="750" y2="112" stroke="black"/>
<line x1="450" y1="95" x2="150" y2="95" stroke="black"/>
<line x1="150" y1="95" x2="160" y2="101" stroke="black"/>
<polygon fill="white" points="186,85 412,85 412,94 186,94"/>
<text x="187" y="94" textLength="224" font-family="Helvetica" font-size="12" fill="black">
Unprovisioned beacon (ADV_NONCONN)
</text>
<line x1="150" y1="112" x2="150" y2="140" stroke="black"/>
<line x1="450" y1="112" x2="450" y2="140" stroke="black"/>
<line x1="750" y1="112" x2="750" y2="140" stroke="black"/>
<line x1="450" y1="123" x2="150" y2="123" stroke="black"/>
<line x1="150" y1="123" x2="160" y2="129" stroke="black"/>
<polygon fill="white" points="207,113 392,113 392,122 207,122"/>
<text x="208" y="122" textLength="183" font-family="Helvetica" font-size="12" fill="black">
Unprovisioned beacon (ADV_IND)
</text>
<line x1="150" y1="140" x2="150" y2="157" stroke="black" stroke-dasharray="2,2"/>
<line x1="450" y1="140" x2="450" y2="157" stroke="black" stroke-dasharray="2,2"/>
<line x1="750" y1="140" x2="750" y2="157" stroke="black" stroke-dasharray="2,2"/>
<line x1="150" y1="157" x2="150" y2="185" stroke="black"/>
<line x1="450" y1="157" x2="450" y2="185" stroke="black"/>
<line x1="750" y1="157" x2="750" y2="185" stroke="black"/>
<line x1="150" y1="168" x2="450" y2="168" stroke="black"/>
<line x1="450" y1="168" x2="440" y2="174" stroke="black"/>
<polygon fill="white" points="264,158 334,158 334,167 264,167"/>
<text x="265" y="167" textLength="68" font-family="Helvetica" font-size="12" fill="black">
CONN_REQ
</text>
<line x1="150" y1="185" x2="150" y2="202" stroke="black"/>
<line x1="450" y1="185" x2="450" y2="202" stroke="black"/>
<line x1="750" y1="185" x2="750" y2="202" stroke="black"/>
<line x1="150" y1="202" x2="150" y2="230" stroke="black"/>
<line x1="450" y1="202" x2="450" y2="230" stroke="black"/>
<line x1="750" y1="202" x2="750" y2="230" stroke="black"/>
<polygon fill="white" points="14,202 586,202 586,224 14,224"/>
<polygon fill="white" points="8,208 592,208 592,218 8,218"/>
<circle fill="white" cx="14" cy="208" r="6"/>
<circle fill="white" cx="586" cy="208" r="6"/>
<circle fill="white" cx="14" cy="218" r="6"/>
<circle fill="white" cx="586" cy="218" r="6"/>
<line x1="14" y1="202" x2="586" y2="202" stroke="black"/>
<line x1="14" y1="224" x2="586" y2="224" stroke="black"/>
<line x1="8" y1="208" x2="8" y2="218" stroke="black"/>
<line x1="592" y1="208" x2="592" y2="218" stroke="black"/>
<path d="M 8 208 A6,6 0 0,1 14,202" stroke="black" fill="none"/><path d="M 586 202 A6,6 0 0,1 592,208" stroke="black" fill="none"/><path d="M 592 218 A6,6 0 0,1 586,224" stroke="black" fill="none"/><path d="M 14 224 A6,6 0 0,1 8,218" stroke="black" fill="none"/><polygon fill="white" points="243,209 356,209 356,218 243,218"/>
<text x="244" y="218" textLength="111" font-family="Helvetica" font-size="12" fill="black">
Provisioning process
</text>
<line x1="150" y1="230" x2="150" y2="247" stroke="black"/>
<line x1="450" y1="230" x2="450" y2="247" stroke="black"/>
<line x1="750" y1="230" x2="750" y2="247" stroke="black"/>
<line x1="150" y1="247" x2="150" y2="275" stroke="black"/>
<line x1="450" y1="247" x2="450" y2="275" stroke="black"/>
<line x1="750" y1="247" x2="750" y2="275" stroke="black"/>
<polygon fill="white" points="14,247 586,247 586,269 14,269"/>
<polygon fill="white" points="14,247 14,269 8,258"/>
<polygon fill="white" points="586,247 586,269 592,258"/>
<line x1="14" y1="247" x2="586" y2="247" stroke="black"/>
<line x1="14" y1="269" x2="586" y2="269" stroke="black"/>
<line x1="14" y1="247" x2="8" y2="258" stroke="black"/>
<line x1="8" y1="258" x2="14" y2="269" stroke="black"/>
<line x1="586" y1="247" x2="592" y2="258" stroke="black"/>
<line x1="592" y1="258" x2="586" y2="269" stroke="black"/>
<polygon fill="white" points="269,254 330,254 330,263 269,263"/>
<text x="270" y="263" textLength="59" font-family="Helvetica" font-size="12" fill="black">
Disconnect
</text>
<line x1="150" y1="275" x2="150" y2="336" stroke="black"/>
<line x1="450" y1="275" x2="450" y2="336" stroke="black"/>
<line x1="750" y1="275" x2="750" y2="336" stroke="black"/>
<polygon fill="white" points="308,275 580,275 580,330 308,330"/>
<polygon fill="white" points="308,287 592,287 592,330 308,330"/>
<polygon fill="white" points="580,275 592,287 580,287"/>
<line x1="308" y1="275" x2="580" y2="275" stroke="black"/>
<line x1="308" y1="330" x2="592" y2="330" stroke="black"/>
<line x1="308" y1="275" x2="308" y2="330" stroke="black"/>
<line x1="592" y1="287" x2="592" y2="330" stroke="black"/>
<line x1="580" y1="275" x2="592" y2="287" stroke="black"/>
<line x1="580" y1="275" x2="580" y2="287" stroke="black"/>
<line x1="592" y1="287" x2="580" y2="287" stroke="black"/>
<polygon fill="white" points="448,276 450,276 450,285 448,285"/>
<text x="449" y="285" textLength="0" font-family="Helvetica" font-size="12" fill="black">

</text>
<polygon fill="white" points="321,287 577,287 577,296 321,296"/>
<text x="322" y="296" textLength="254" font-family="Helvetica" font-size="12" fill="black">
The device resets its GATT database, removing
</text>
<polygon fill="white" points="320,298 578,298 578,307 320,307"/>
<text x="321" y="307" textLength="256" font-family="Helvetica" font-size="12" fill="black">
the Provisioning service and replacing it with the
</text>
<polygon fill="white" points="411,309 488,309 488,318 411,318"/>
<text x="412" y="318" textLength="75" font-family="Helvetica" font-size="12" fill="black">
Proxy service.
</text>
<polygon fill="white" points="448,320 450,320 450,329 448,329"/>
<text x="449" y="329" textLength="0" font-family="Helvetica" font-size="12" fill="black">

</text>
<line x1="150" y1="336" x2="150" y2="364" stroke="black"/>
<line x1="450" y1="336" x2="450" y2="364" stroke="black"/>
<line x1="750" y1="336" x2="750" y2="364" stroke="black"/>
<line x1="450" y1="347" x2="150" y2="347" stroke="black"/>
<line x1="150" y1="347" x2="160" y2="353" stroke="black"/>
<polygon fill="white" points="231,337 367,337 367,346 231,346"/>
<text x="232" y="346" textLength="134" font-family="Helvetica" font-size="12" fill="black">
Node Identity (ADV_IND)
</text>
<line x1="150" y1="364" x2="150" y2="414" stroke="black"/>
<line x1="450" y1="364" x2="450" y2="414" stroke="black"/>
<line x1="750" y1="364" x2="750" y2="414" stroke="black"/>
<polygon fill="white" points="308,364 580,364 580,408 308,408"/>
<polygon fill="white" points="308,376 592,376 592,408 308,408"/>
<polygon fill="white" points="580,364 592,376 580,376"/>
<line x1="308" y1="364" x2="580" y2="364" stroke="black"/>
<line x1="308" y1="408" x2="592" y2="408" stroke="black"/>
<line x1="308" y1="364" x2="308" y2="408" stroke="black"/>
<line x1="592" y1="376" x2="592" y2="408" stroke="black"/>
<line x1="580" y1="364" x2="592" y2="376" stroke="black"/>
<line x1="580" y1="364" x2="580" y2="376" stroke="black"/>
<line x1="592" y1="376" x2="580" y2="376" stroke="black"/>
<polygon fill="white" points="448,365 450,365 450,374 448,374"/>
<text x="449" y="374" textLength="0" font-family="Helvetica" font-size="12" fill="black">

</text>
<polygon fill="white" points="325,376 574,376 574,385 325,385"/>
<text x="326" y="385" textLength="247" font-family="Helvetica" font-size="12" fill="black">
If the provisioner does not connect within 60 s,
</text>
<polygon fill="white" points="319,387 579,387 579,396 319,396"/>
<text x="320" y="396" textLength="258" font-family="Helvetica" font-size="12" fill="black">
the device starts advertising the Network Identity
</text>
<polygon fill="white" points="427,398 471,398 471,407 427,407"/>
<text x="428" y="407" textLength="42" font-family="Helvetica" font-size="12" fill="black">
instead.
</text>
<line x1="150" y1="414" x2="150" y2="442" stroke="black"/>
<line x1="450" y1="414" x2="450" y2="442" stroke="black"/>
<line x1="750" y1="414" x2="750" y2="442" stroke="black"/>
<line x1="150" y1="425" x2="450" y2="425" stroke="black"/>
<line x1="450" y1="425" x2="440" y2="431" stroke="black"/>
<polygon fill="white" points="264,415 334,415 334,424 264,424"/>
<text x="265" y="424" textLength="68" font-family="Helvetica" font-size="12" fill="black">
CONN_REQ
</text>
<line x1="150" y1="442" x2="150" y2="470" stroke="black"/>
<line x1="450" y1="442" x2="450" y2="470" stroke="black"/>
<line x1="750" y1="442" x2="750" y2="470" stroke="black"/>
<line x1="150" y1="453" x2="450" y2="453" stroke="black"/>
<line x1="450" y1="453" x2="440" y2="459" stroke="black"/>
<polygon fill="white" points="239,443 359,443 359,452 239,452"/>
<text x="240" y="452" textLength="118" font-family="Helvetica" font-size="12" fill="black">
Composition Data Get
</text>
<line x1="150" y1="470" x2="150" y2="498" stroke="black"/>
<line x1="450" y1="470" x2="450" y2="498" stroke="black"/>
<line x1="750" y1="470" x2="750" y2="498" stroke="black"/>
<line x1="450" y1="481" x2="150" y2="481" stroke="black"/>
<line x1="150" y1="481" x2="160" y2="487" stroke="black"/>
<polygon fill="white" points="232,471 367,471 367,480 232,480"/>
<text x="233" y="480" textLength="133" font-family="Helvetica" font-size="12" fill="black">
Composition Data Status
</text>
<line x1="150" y1="498" x2="150" y2="526" stroke="black"/>
<line x1="450" y1="498" x2="450" y2="526" stroke="black"/>
<line x1="750" y1="498" x2="750" y2="526" stroke="black"/>
<line x1="150" y1="509" x2="450" y2="509" stroke="black"/>
<line x1="450" y1="509" x2="440" y2="515" stroke="black"/>
<polygon fill="white" points="263,499 335,499 335,508 263,508"/>
<text x="264" y="508" textLength="70" font-family="Helvetica" font-size="12" fill="black">
App Key Add
</text>
<line x1="150" y1="526" x2="150" y2="554" stroke="black"/>
<line x1="450" y1="526" x2="450" y2="554" stroke="black"/>
<line x1="750" y1="526" x2="750" y2="554" stroke="black"/>
<line x1="450" y1="537" x2="150" y2="537" stroke="black"/>
<line x1="150" y1="537" x2="160" y2="543" stroke="black"/>
<polygon fill="white" points="257,527 342,527 342,536 257,536"/>
<text x="258" y="536" textLength="83" font-family="Helvetica" font-size="12" fill="black">
App Key Status
</text>
<line x1="150" y1="554" x2="150" y2="582" stroke="black"/>
<line x1="450" y1="554" x2="450" y2="582" stroke="black"/>
<line x1="750" y1="554" x2="750" y2="582" stroke="black"/>
<polygon fill="white" points="8,554 880,554 880,576 8,576"/>
<polygon fill="white" points="8,566 892,566 892,576 8,576"/>
<polygon fill="white" points="880,554 892,566 880,566"/>
<line x1="8" y1="554" x2="880" y2="554" stroke="black"/>
<line x1="8" y1="576" x2="892" y2="576" stroke="black"/>
<line x1="8" y1="554" x2="8" y2="576" stroke="black"/>
<line x1="892" y1="566" x2="892" y2="576" stroke="black"/>
<line x1="880" y1="554" x2="892" y2="566" stroke="black"/>
<line x1="880" y1="554" x2="880" y2="566" stroke="black"/>
<line x1="892" y1="566" x2="880" y2="566" stroke="black"/>
<polygon fill="white" points="253,561 645,561 645,570 253,570"/>
<text x="254" y="570" textLength="390" font-family="Helvetica" font-size="12" fill="black">
The provisioner may commuticate with Node 2, using Node 1 as a bridge.
</text>
<line x1="150" y1="582" x2="150" y2="610" stroke="black"/>
<line x1="450" y1="582" x2="450" y2="610" stroke="black"/>
<line x1="750" y1="582" x2="750" y2="610" stroke="black"/>
<line x1="150" y1="593" x2="450" y2="593" stroke="black"/>
<line x1="450" y1="593" x2="440" y2="599" stroke="black"/>
<polygon fill="white" points="182,583 417,583 417,592 182,592"/>
<text x="183" y="592" textLength="233" font-family="Helvetica" font-size="12" fill="black">
Composition Data Get (destination: Node 2)
</text>
<line x1="450" y1="593" x2="750" y2="593" stroke="black"/>
<line x1="750" y1="593" x2="740" y2="599" stroke="black"/>
<polygon fill="white" points="520,583 679,583 679,592 520,592"/>
<text x="521" y="592" textLength="157" font-family="Helvetica" font-size="12" fill="black">
Relayed over the ADV bearer
</text>
<line x1="150" y1="610" x2="150" y2="638" stroke="black"/>
<line x1="450" y1="610" x2="450" y2="638" stroke="black"/>
<line x1="750" y1="610" x2="750" y2="638" stroke="black"/>
<line x1="750" y1="621" x2="450" y2="621" stroke="black"/>
<line x1="450" y1="621" x2="460" y2="627" stroke="black"/>
<polygon fill="white" points="465,611 734,611 734,620 465,620"/>
<text x="466" y="620" textLength="267" font-family="Helvetica" font-size="12" fill="black">
Composition Data Status (destination: provisioner)
</text>
<line x1="450" y1="621" x2="150" y2="621" stroke="black"/>
<line x1="150" y1="621" x2="160" y2="627" stroke="black"/>
<polygon fill="white" points="216,611 382,611 382,620 216,620"/>
<text x="217" y="620" textLength="164" font-family="Helvetica" font-size="12" fill="black">
Relayed over the GATT bearer
</text>
<line x1="150" y1="638" x2="150" y2="666" stroke="black"/>
<line x1="450" y1="638" x2="450" y2="666" stroke="black"/>
<line x1="750" y1="638" x2="750" y2="666" stroke="black"/>
<polygon fill="white" points="14,638 586,638 586,660 14,660"/>
<polygon fill="white" points="14,638 14,660 8,649"/>
<polygon fill="white" points="586,638 586,660 592,649"/>
<line x1="14" y1="638" x2="586" y2="638" stroke="black"/>
<line x1="14" y1="660" x2="586" y2="660" stroke="black"/>
<line x1="14" y1="638" x2="8" y2="649" stroke="black"/>
<line x1="8" y1="649" x2="14" y2="660" stroke="black"/>
<line x1="586" y1="638" x2="592" y2="649" stroke="black"/>
<line x1="592" y1="649" x2="586" y2="660" stroke="black"/>
<polygon fill="white" points="269,645 330,645 330,654 269,654"/>
<text x="270" y="654" textLength="59" font-family="Helvetica" font-size="12" fill="black">
Disconnect
</text>
<line x1="150" y1="666" x2="150" y2="694" stroke="black"/>
<line x1="450" y1="666" x2="450" y2="694" stroke="black"/>
<line x1="750" y1="666" x2="750" y2="694" stroke="black"/>
<line x1="450" y1="677" x2="150" y2="677" stroke="black"/>
<line x1="150" y1="677" x2="160" y2="683" stroke="black"/>
<polygon fill="white" points="269,667 330,667 330,676 269,676"/>
<text x="270" y="676" textLength="59" font-family="Helvetica" font-size="12" fill="black">
Network ID
</text>
<line x1="150" y1="688" x2="150" y2="694" stroke="black"/>
<line x1="450" y1="688" x2="450" y2="694" stroke="black"/>
<line x1="750" y1="688" x2="750" y2="694" stroke="black"/>
</svg>
