<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1148px" preserveAspectRatio="none" style="width:859px;height:1148px;" version="1.1" viewBox="0 0 859 1148" width="859px" zoomAndPan="magnify"><defs><filter height="300%" id="fuszvggfhdnwr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" height="1133.9551" style="stroke: #A80036; stroke-width: 1.0;" width="317" x="100" y="4"/><text fill="#000000" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="222.5" y="16.4065">Application</text><rect fill="#DDDDDD" height="1133.9551" style="stroke: #A80036; stroke-width: 1.0;" width="149" x="682" y="4"/><rect fill="#FFFFFF" filter="url(#fuszvggfhdnwr)" height="529.229" style="stroke: #000000; stroke-width: 2.0;" width="753" x="94" y="537.5288"/><rect fill="#FFFFFF" height="355.8364" style="stroke: none; stroke-width: 1.0;" width="753" x="94" y="710.9214"/><rect fill="#FFFFFF" filter="url(#fuszvggfhdnwr)" height="113.7949" style="stroke: #000000; stroke-width: 2.0;" width="585" x="252" y="789.519"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133" x2="133" y1="74.146" y2="138.0435"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="133" x2="133" y1="138.0435" y2="178.6924"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133" x2="133" y1="178.6924" y2="323.436"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="133" x2="133" y1="323.436" y2="364.085"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133" x2="133" y1="364.085" y2="421.9824"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="133" x2="133" y1="421.9824" y2="462.6313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133" x2="133" y1="462.6313" y2="554.4775"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="133" x2="133" y1="554.4775" y2="595.1265"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133" x2="133" y1="595.1265" y2="712.9214"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="133" x2="133" y1="712.9214" y2="753.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133" x2="133" y1="753.5703" y2="910.314"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="133" x2="133" y1="910.314" y2="950.9629"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133" x2="133" y1="950.9629" y2="1083.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343" x2="343" y1="74.146" y2="138.0435"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="343" x2="343" y1="138.0435" y2="178.6924"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343" x2="343" y1="178.6924" y2="323.436"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="343" x2="343" y1="323.436" y2="364.085"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343" x2="343" y1="364.085" y2="421.9824"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="343" x2="343" y1="421.9824" y2="462.6313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343" x2="343" y1="462.6313" y2="554.4775"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="343" x2="343" y1="554.4775" y2="595.1265"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343" x2="343" y1="595.1265" y2="712.9214"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="343" x2="343" y1="712.9214" y2="753.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343" x2="343" y1="753.5703" y2="910.314"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="343" x2="343" y1="910.314" y2="950.9629"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343" x2="343" y1="950.9629" y2="1083.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="467" y1="74.146" y2="138.0435"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="467" x2="467" y1="138.0435" y2="178.6924"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="467" y1="178.6924" y2="323.436"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="467" x2="467" y1="323.436" y2="364.085"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="467" y1="364.085" y2="421.9824"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="467" x2="467" y1="421.9824" y2="462.6313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="467" y1="462.6313" y2="554.4775"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="467" x2="467" y1="554.4775" y2="595.1265"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="467" y1="595.1265" y2="712.9214"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="467" x2="467" y1="712.9214" y2="753.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="467" y1="753.5703" y2="910.314"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="467" x2="467" y1="910.314" y2="950.9629"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="467" y1="950.9629" y2="1083.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599" x2="599" y1="74.146" y2="138.0435"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="599" x2="599" y1="138.0435" y2="178.6924"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599" x2="599" y1="178.6924" y2="323.436"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="599" x2="599" y1="323.436" y2="364.085"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599" x2="599" y1="364.085" y2="421.9824"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="599" x2="599" y1="421.9824" y2="462.6313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599" x2="599" y1="462.6313" y2="554.4775"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="599" x2="599" y1="554.4775" y2="595.1265"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599" x2="599" y1="595.1265" y2="712.9214"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="599" x2="599" y1="712.9214" y2="753.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599" x2="599" y1="753.5703" y2="910.314"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="599" x2="599" y1="910.314" y2="950.9629"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599" x2="599" y1="950.9629" y2="1083.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="74.146" y2="138.0435"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="756" x2="756" y1="138.0435" y2="178.6924"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="178.6924" y2="323.436"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="756" x2="756" y1="323.436" y2="364.085"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="364.085" y2="421.9824"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="756" x2="756" y1="421.9824" y2="462.6313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="462.6313" y2="554.4775"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="756" x2="756" y1="554.4775" y2="595.1265"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="595.1265" y2="712.9214"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="756" x2="756" y1="712.9214" y2="753.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="753.5703" y2="910.314"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="756" x2="756" y1="910.314" y2="950.9629"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="950.9629" y2="1083.7578"/><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="104" y="39.0474"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="111" y="59.4082">main.c</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="104" y="1082.7578"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="111" y="1103.1187">main.c</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="46.1973" style="stroke: #A80036; stroke-width: 1.5;" width="135" x="274" y="22.9487"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="281" y="43.3096">Application support</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="315" y="59.4082">modules</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="46.1973" style="stroke: #A80036; stroke-width: 1.5;" width="135" x="274" y="1082.7578"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="281" y="1103.1187">Application support</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="315" y="1119.2173">modules</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="423" y="39.0474"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="430" y="59.4082">Mesh stack</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="423" y="1082.7578"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="430" y="1103.1187">Mesh stack</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="522" y="39.0474"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="529" y="59.4082">Generic OnOff server</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="522" y="1082.7578"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="529" y="1103.1187">Generic OnOff server</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="686" y="39.0474"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="693" y="59.4082">Mesh core modules</text><rect fill="#FEFECE" filter="url(#fuszvggfhdnwr)" height="30.0986" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="686" y="1082.7578"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="693" y="1103.1187">Mesh core modules</text><polygon fill="#FBFB77" filter="url(#fuszvggfhdnwr)" points="8,89.146,8,128.146,255,128.146,255,99.146,245,89.146,8,89.146" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="245" x2="245" y1="89.146" y2="99.146"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="255" x2="245" y1="99.146" y2="99.146"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="14" y="106.5525">init_params defines UUID, core params</text><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="18" y="121.5012">and event callbacks</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="426.5" y="162.5413">Initialize</text><polygon fill="#A80036" points="331.5,194.6924,341.5,198.6924,331.5,202.6924,335.5,198.6924" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="337.5" y1="198.6924" y2="198.6924"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="140.5" y="195.0989">ble_stack_init()</text><polygon fill="#A80036" points="331.5,223.6411,341.5,227.6411,331.5,231.6411,335.5,227.6411" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="337.5" y1="227.6411" y2="227.6411"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="140.5" y="224.0476">gap_params_init()</text><polygon fill="#A80036" points="331.5,252.5898,341.5,256.5898,331.5,260.5898,335.5,256.5898" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="337.5" y1="256.5898" y2="256.5898"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="140.5" y="252.9963">conn_params_init()</text><polygon fill="#A80036" points="455.5,281.5386,465.5,285.5386,455.5,289.5386,459.5,285.5386" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="461.5" y1="285.5386" y2="285.5386"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="140.5" y="281.9451">mesh_stack_init(...)</text><polygon fill="#A80036" points="744.5,310.4873,754.5,314.4873,744.5,318.4873,748.5,314.4873" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467.5" x2="750.5" y1="314.4873" y2="314.4873"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="474.5" y="310.8938">Initialize: Mesh and Foundation models</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="446.5" y="347.9338"/><polygon fill="#A80036" points="331.5,380.085,341.5,384.085,331.5,388.085,335.5,384.085" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="337.5" y1="384.085" y2="384.085"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="140.5" y="380.4915">app_onoff_init(...)</text><polygon fill="#A80036" points="587,409.0337,597,413.0337,587,417.0337,591,413.0337" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="593" y1="413.0337" y2="413.0337"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="350.5" y="409.4402">generic_onoff_server_init(...)</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="433.5" y="446.4802">Start</text><polygon fill="#A80036" points="455.5,478.6313,465.5,482.6313,455.5,486.6313,459.5,482.6313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="461.5" y1="482.6313" y2="482.6313"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="140.5" y="479.0378">mesh_stack_start()</text><polygon fill="#FBFB77" filter="url(#fuszvggfhdnwr)" points="389,496.5801,389,520.5801,542,520.5801,542,506.5801,532,496.5801,389,496.5801" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="532" x2="532" y1="496.5801" y2="506.5801"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="542" x2="532" y1="506.5801" y2="506.5801"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="395" y="513.9866">Start dynamic behavior</text><rect fill="none" height="529.229" style="stroke: #000000; stroke-width: 2.0;" width="753" x="94" y="537.5288"/><polygon fill="#EEEEEE" points="94,537.5288,155,537.5288,155,543.5288,145,553.5288,94,553.5288,94,537.5288" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="109" y="550.9353">alt</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="83" x="403.5" y="578.9753">Provisioned node</text><polygon fill="#A80036" points="354.5,611.1265,344.5,615.1265,354.5,619.1265,350.5,615.1265" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="348.5" x2="598" y1="615.1265" y2="615.1265"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="360.5" y="611.533">Model APIs: get_cb(...), set_cb(...)</text><polygon fill="#A80036" points="144.5,640.0752,134.5,644.0752,144.5,648.0752,140.5,644.0752" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="138.5" x2="342.5" y1="644.0752" y2="644.0752"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="150.5" y="640.4817">app_onoff_get/set_cb(...)</text><polygon fill="#A80036" points="331.5,669.0239,341.5,673.0239,331.5,677.0239,335.5,673.0239" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="337.5" y1="673.0239" y2="673.0239"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="140.5" y="669.4304">app_onoff_status_publish(...)</text><polygon fill="#A80036" points="587,697.9727,597,701.9727,587,705.9727,591,701.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="593" y1="701.9727" y2="701.9727"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="350.5" y="698.3792">generic_onoff_server_status_publish(...)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="94" x2="847" y1="711.9214" y2="711.9214"/><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="104" x="393" y="737.4192">Unprovisioned device</text><polygon fill="#A80036" points="331.5,769.5703,341.5,773.5703,331.5,777.5703,335.5,773.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="337.5" y1="773.5703" y2="773.5703"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="140.5" y="769.9768">mesh_provisionee_prov_start(...)</text><rect fill="none" height="113.7949" style="stroke: #000000; stroke-width: 2.0;" width="585" x="252" y="789.519"/><polygon fill="#EEEEEE" points="252,789.519,430,789.519,430,795.519,420,805.519,252,805.519,252,789.519" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Arial" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="267" y="802.9255">Initialize provisionee</text><polygon fill="#FBFB77" filter="url(#fuszvggfhdnwr)" points="262,811.4678,262,835.4678,421,835.4678,421,821.4678,411,811.4678,262,811.4678" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="411" x2="411" y1="811.4678" y2="821.4678"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="421" x2="411" y1="821.4678" y2="821.4678"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="268" y="828.8743">Define OOB capabilities</text><polygon fill="#A80036" points="744.5,861.4165,754.5,865.4165,744.5,869.4165,748.5,865.4165" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="750.5" y1="865.4165" y2="865.4165"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="350.5" y="861.823">Start unprovisioned device beacon</text><polygon fill="#A80036" points="744.5,890.3652,754.5,894.3652,744.5,898.3652,748.5,894.3652" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="343.5" x2="750.5" y1="894.3652" y2="894.3652"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="350.5" y="890.7717">Listen for provisioning invite</text><text fill="#000000" font-family="Arial" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="157" x="366.5" y="934.8118">Wait for provisioning to complete</text><polygon fill="#A80036" points="354.5,966.9629,344.5,970.9629,354.5,974.9629,350.5,970.9629" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="348.5" x2="755.5" y1="970.9629" y2="970.9629"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="360.5" y="967.3694">Provisioning Events</text><polygon fill="#A80036" points="144.5,995.9116,134.5,999.9116,144.5,1003.9116,140.5,999.9116" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="138.5" x2="342.5" y1="999.9116" y2="999.9116"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="150.5" y="996.3181">provisioning_complete_cb()</text><polygon fill="#A80036" points="331.5,1024.8604,341.5,1028.8604,331.5,1032.8604,335.5,1028.8604" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="337.5" y1="1028.8604" y2="1028.8604"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="140.5" y="1025.2668">gap_params_init()</text><polygon fill="#A80036" points="331.5,1053.8091,341.5,1057.8091,331.5,1061.8091,335.5,1057.8091" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="133.5" x2="337.5" y1="1057.8091" y2="1057.8091"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="140.5" y="1054.2156">conn_params_init()</text><!--
@startuml
skinparam defaultFontName Arial
box "Application" #FFFFFF
participant a as "main.c"
participant ah as "Application support\nmodules"
end box
participant c as "Mesh stack"
participant s as "Generic OnOff server"
box
participant core as "Mesh core modules"
end box

note over a: init_params defines UUID, core params\n and event callbacks
... Initialize ...
a -> ah: ble_stack_init()
a -> ah: gap_params_init()
a -> ah: conn_params_init()
a -> c: mesh_stack_init(...)
c -> core: Initialize: Mesh and Foundation models
... ...
a -> ah: app_onoff_init(...)
ah -> s: generic_onoff_server_init(...)
... Start ...
a -> c: mesh_stack_start()
note over c: Start dynamic behavior


alt
    ... Provisioned node ...
    ah <- s: Model APIs: get_cb(...), set_cb(...)
    a <- ah: app_onoff_get/set_cb(...)
    a -> ah: app_onoff_status_publish(...)
    ah -> s: generic_onoff_server_status_publish(...)

else
    ... Unprovisioned device ...
    a -> ah: mesh_provisionee_prov_start(...)
    group Initialize provisionee
    note over ah: Define OOB capabilities
    ah -> core: Start unprovisioned device beacon
    ah -> core: Listen for provisioning invite
    end
    ... Wait for provisioning to complete ...
    core -> ah: Provisioning Events
    ah -> a: provisioning_complete_cb()
    a -> ah: gap_params_init()
    a -> ah: conn_params_init()
end

@enduml

PlantUML version 1.2017.16(Sun Sep 03 12:53:37 CEST 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_191-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>